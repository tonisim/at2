var wpglobus_wpseo=function(){if("undefined"!=typeof wpseoMetaboxL10n){var e=function(e,t){var a="",s=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+t),o=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title-length-warning_"+t),n=jQuery("<div />"),r=jQuery("#wpseosnippet_title_"+t);if(s.val()?a=s.val():(a=wpseoMetaboxL10n.wpseo_title_template,a=n.html(a).text()),""==a)return r.html(""),void o.hide();a=yst_clean(a),a=jQuery.trim(a),a=n.text(a).html(),e&&s.val(a),a=function(e,t,a){if(void 0===e)return"";if("undefined"==typeof replacedVars&&0==jQuery("#title").size())return e;var s="#title",o="#excerpt-"+t,n="#content";t!=WPGlobusAdmin.data.default_language&&(s="#title_"+t,n="#content_"+t),jQuery(s).length&&(e=e.replace(/%%title%%/g,jQuery(s).val())),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/%%sitedesc%%/g,WPGlobusAdmin.data.blogdescription[t])).replace(/%%sitename%%/g,WPGlobusAdmin.data.blogname[t])).replace(/%%sep%%/g,wpseoMetaboxL10n.sep)).replace(/%%date%%/g,wpseoMetaboxL10n.date)).replace(/%%id%%/g,wpseoMetaboxL10n.id)).replace(/%%page%%/g,wpseoMetaboxL10n.page)).replace(/%%currenttime%%/g,wpseoMetaboxL10n.currenttime)).replace(/%%currentdate%%/g,wpseoMetaboxL10n.currentdate)).replace(/%%currentday%%/g,wpseoMetaboxL10n.currentday)).replace(/%%currentmonth%%/g,wpseoMetaboxL10n.currentmonth)).replace(/%%currentyear%%/g,wpseoMetaboxL10n.currentyear)).replace(/%%focuskw%%/g,jQuery("#yoast_wpseo_focuskw_"+t).val());var r="";jQuery(o).length&&(r=yst_clean(jQuery(o).val()),e=e.replace(/%%excerpt_only%%/g,r)),""==r&&jQuery(n).length&&(r=jQuery(n).val().replace(/(<([^>]+)>)/gi,"").substring(0,wpseoMetaboxL10n.wpseo_meta_desc_length-1)),e=e.replace(/%%excerpt%%/g,r),jQuery("#parent_id").length&&jQuery("#parent_id option:selected").text()!=wpseoMetaboxL10n.no_parent_text&&(e=e.replace(/%%parent_title%%/g,jQuery("#parent_id option:selected").text()));var l=yst_escapeFocusKw(wpseoMetaboxL10n.sep),p=new RegExp(l+" "+l,"g");if(-1!=(e=e.replace(p,wpseoMetaboxL10n.sep)).indexOf("%%")&&null!=e.match(/%%[a-z0-9_-]+%%/i))for(regex=/%%[a-z0-9_-]+%%/gi,matches=e.match(regex),i=0;i<matches.length;i++)void 0!=replacedVars[matches[i]]?e=e.replace(matches[i],replacedVars[matches[i]]):(replaceableVar=matches[i],replacedVars[replaceableVar]="",jQuery.post(ajaxurl,{action:"wpseo_replace_vars",string:matches[i],post_id:jQuery("#post_ID").val(),_wpnonce:wpseoMetaboxL10n.wpseo_replace_vars_nonce},function(t){t?(replacedVars[replaceableVar]=t,yst_replaceVariables(e,a)):yst_replaceVariables(e,a)}));a(e)}(a,t,function(e){var a=n.html(e).text();s.attr("placeholder",a),e=l(e=yst_clean(e),!1,t),jQuery("#wpseosnippet_title_"+t).html(e);var r=document.getElementById("wpseosnippet_title_"+t);null!=r&&(r.scrollWidth>r.clientWidth?o.show():o.hide()),u(t)})},t=function(t){e(!1,t),p(t)};jQuery("#wpglobus-wpseo-tabs").tabs();var a=jQuery("#wpglobus-wpseo-attr"),s=jQuery(".wpseotab.general .form-table"),o=a.data("ids"),n=a.data("names"),r="";o=(o=o+","+a.data("qtip")).split(","),n=n.split(","),jQuery("#wpglobus-wpseo-tabs").insertBefore(s),jQuery(".wpglobus-wpseo-general").each(function(a,l){var u=jQuery(l),i=u.data("language");if(u.html('<table class="form-table wpglobus-table-'+i+'" data-language="'+i+'">'+s.html()+"</table>"),jQuery.each(n,function(e,t){jQuery("#"+t).attr("name",t+"_"+i)}),jQuery.each(o,function(e,t){var a=jQuery("#"+t);"wpseosnippet"==t&&a.addClass("wpglobus-wpseosnippet"),"focuskwresults"==t&&a.addClass("wpglobus-focuskwresults"),wpseoMetaboxL10n.field_prefix+"metadesc"==t&&a.addClass("wpglobus-wpseo_metadesc").text(u.data("metadesc")),wpseoMetaboxL10n.field_prefix+"title"==t&&a.addClass("wpglobus-wpseo_title").val(u.data("wpseotitle")),wpseoMetaboxL10n.field_prefix+"focuskw"==t&&a.addClass("wpglobus-wpseo_focuskw").val(u.data("focuskw")),a.attr("id",t+"_"+i),jQuery("#"+t+"_"+i).attr("data-language",i)}),r="complete"==u.data("permalink")?u.data("url-"+i):u.data("url-"+i)+jQuery("#editable-post-name-full").text()+"/",jQuery("#wpseosnippet_"+i+" .url").text(r),t(i),void 0!==jQuery().autocomplete){var c,d={};jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+i).autocomplete({minLength:3,formatResult:function(e){return jQuery("<div/>").html(e).html()},source:function(e,t){var a=e.term;a in d?t(d[a]):(e._ajax_nonce=wpseoMetaboxL10n.wpseo_keyword_suggest_nonce,e.action="wpseo_get_suggest",c=jQuery.getJSON(ajaxurl,e,function(e,s,o){d[a]=e,o===c&&t(e)}))}})}jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+i).keyup(function(){e(!1,jQuery(this).data("language"))}),jQuery("#title_"+i).keyup(function(){var t=jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language;e(!1,t),p(t)}),0==a&&jQuery("#title").keyup(function(){e(!1,WPGlobusAdmin.data.default_language),p(WPGlobusAdmin.data.default_language)}),0==a&&jQuery("body").on("change","#parent_id",function(){jQuery.each(WPGlobusAdmin.data.enabled_languages,function(t,a){e(!1,a),p(a)})}),jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+i).keyup(function(){p(jQuery(this).data("language"))}),jQuery("body").on("keyup","#excerpt-"+i,function(){p(jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language)}),0==a&&jQuery(".wpglobus-editor").focusout(function(){p(jQuery(this).data("language"))});var _=!1;jQuery(document).on("change","#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+i,function(){var e=jQuery(this).data("language"),a=jQuery("#focuskwhelp_"+e);-1!=jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+e).val().search(",")?(a.click(),_=!0):_&&(a.qtip("hide"),_=!1),t(e)})}),s.addClass("hidden"),jQuery("body").on("change",".wpglobus-wpseo_metadesc",function(e){var t="#"+wpseoMetaboxL10n.field_prefix+"metadesc",a=jQuery(this);jQuery(t).val(WPGlobusCore.getString(jQuery(t).val(),a.val(),a.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_title",function(e){var t="#"+wpseoMetaboxL10n.field_prefix+"title",a=jQuery(this);jQuery(t).val(WPGlobusCore.getString(jQuery(t).val(),a.val(),a.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_focuskw",function(e){var t="#"+wpseoMetaboxL10n.field_prefix+"focuskw",a=jQuery(this);jQuery(t).val(WPGlobusCore.getString(jQuery(t).val(),a.val(),a.data("language")))}),jQuery("body").on("click",".wpglobus-post-body-tabs-list li",function(e){$this=jQuery(this),$this.hasClass("wpglobus-post-tab")&&jQuery("#wpglobus-wpseo-tabs").tabs("option","active",jQuery(this).data("order"))}),jQuery(".yoast_help").qtip({content:{attr:"alt"},position:{my:"bottom left",at:"top center"},style:{tip:{corner:!0},classes:"yoast-qtip qtip-rounded qtip-blue"},show:{when:{event:"mouseover"}},hide:{fixed:!0,when:{event:"mouseout"}}}),yst_updateSnippet()}function l(e,t,a){var s,o=yst_escapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val()));if(""==o)return e;s=-1!=o.search(" ")?o.split(" "):new Array(o);for(var n=0;n<s.length;n++){var r=yst_clean(s[n]),l="";t?(r=r.replace(" ","-").toLowerCase(),l=new RegExp("([-/])("+r+")([-/])?")):l=new RegExp("(^|[ s\n\r\t.,'(\"+;!?:-]+)("+r+")($|[ s\n\r\t.,')\"+;!?:-]+)","gim"),void 0!=e&&(e=e.replace(l,"$1<strong>$2</strong>$3"))}return e}function p(e){var t=jQuery.trim(yst_clean(jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+e).val())),a=jQuery("<div />"),s=jQuery("#wpseosnippet_"+e);if(""==t&&""!=wpseoMetaboxL10n.wpseo_metadesc_template&&(t=wpseoMetaboxL10n.wpseo_metadesc_template),""!=t)t=yst_replaceVariables(t,function(t){t=a.text(t).html(),t=yst_clean(t);var o;o=(o=wpseoMetaboxL10n.wpseo_meta_desc_length-t.length)<0?'<span class="wrong">'+o+"</span>":'<span class="good">'+o+"</span>",jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+e).html(o),t=l(t=yst_trimDesc(t),!1),s.find(".desc span.autogen").html(""),s.find(".desc span.content").html(t),u(e)});else{jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+e).html(wpseoMetaboxL10n.wpseo_meta_desc_length),s.find(".desc span.content").html(""),u(e);var o="#content";e!=WPGlobusAdmin.data.default_language&&(o="#content_"+e),jQuery(o).length&&(t=jQuery(o).val(),t=yst_clean(t));var n=yst_escapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+e).val()));if(""!=n){var r=new RegExp(n,"gim");t=-1!=t.search(r)&&t.length>wpseoMetaboxL10n.wpseo_meta_desc_length?t.substr(t.search(r),wpseoMetaboxL10n.wpseo_meta_desc_length):t.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length)}else t=t.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length);t=l(t,!1),t=yst_trimDesc(t),s.find(".desc span.autogen").html(t)}}function u(e){var t=jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+e).val());t=yst_escapeFocusKw(t).toLowerCase();var a="#title",s="#content";e!=WPGlobusAdmin.data.default_language&&(a="#title_"+e,s="#content_"+e);var o=jQuery(document).triggerHandler("wpglobus_post_name_full",{postnamefull:"#editable-post-name-full",language:e})||"#editable-post-name-full";if(jQuery(o).length)var n=jQuery(o).text(),r=wpseoMetaboxL10n.wpseo_permalink_template.replace("%postname%",n).replace("http://","");var l=new RegExp("(^|[ s\n\r\t.,'(\"+;!?:-])"+t+"($|[ s\n\r\t.,')\"+!?:;-])","gim"),p=removeLowerCaseDiacritics(t),u=new RegExp(p.replace(/\s+/g,"[-_\\//]"),"gim"),i=jQuery("#focuskwresults_"+e),c=jQuery("#wpseosnippet_"+e).find(".desc span.content").text();if(""!=t){var d="<p>"+wpseoMetaboxL10n.keyword_header+"</p>";d+="<ul>",jQuery(a).length&&(d+="<li>"+wpseoMetaboxL10n.article_header_text+ptest(jQuery(a).val(),l)+"</li>"),d+="<li>"+wpseoMetaboxL10n.page_title_text+ptest(jQuery("#wpseosnippet_title_"+e).text(),l)+"</li>",d+="<li>"+wpseoMetaboxL10n.page_url_text+ptest(r,u)+"</li>",jQuery(s).length&&(d+="<li>"+wpseoMetaboxL10n.content_text+ptest(jQuery(s).val(),l)+"</li>"),d+="<li>"+wpseoMetaboxL10n.meta_description_text+ptest(c,l)+"</li>",d+="</ul>",i.html(d)}else i.html("")}};